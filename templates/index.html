{% extends "layout.html" %}

{% block nav %}
{% endblock %}
{% block content %}
<div class="container">
    <h1 class="display-4" style="text-align: center; margin-top: 20px; font-family:'Roboto', sans-serif; font-weight: 500"><b><i class="material-icons" style="vertical-align: bottom; font-size: 56px">book</i>PhenCards</b></h1>
	<p class="lead" style="text-align:center; font-weight: 300;">PhenCards is a search engine for compiling various information linked to phenotype terms.</p>
</div>
<div class="container">
	<form action="{{ url_for('phencards') }}" method="post" ENCTYPE="multipart/form-data" role="form" >

                <!-- invisible checkbox that is checked if using doc2hpo, unchecked otherwise -->
                <div class="form-check" style="display:none;">
                    <input class="form-check-input" type="checkbox" value="doc2hpo" id="doc2hpo_check" name="doc2hpo_check">
                    <label class="form-check-label" for="doc2hpo_check">
                    </label>
                </div>

                <ul class="nav nav-tabs">
                    <!-- tab for autocompletion integration -->
                    <li class="nav-item">
                        <a class="nav-link active" id="auto-tab" href="#auto">Phenotype search</a>
                    </li>
                    <!-- tab for Doc2Hpo integration -->
                    <li class="nav-item">
                        <a class="nav-link" id="doc2hpo-tab" href="#doc2hpo">Patient notes</a>
                    </li>
                </ul>

                

                <br>

        
       <!-- text box to enter phenotype with autocompletion -->
		<div class="form-group" id="auto" style="display:inline;">
                <hr>
                <div class="container" style="text-align:center">
                <code style="font-weight: 300; background-color: #ffffff; color: #555555;">Start typing a phenotype term: fitness, disease or symptom (e.g. cleft palate, epilepsy, Rett syndrome). Our autocompletion will help you.<br>Your query does not have to match a preexisting term.</code>
                </div>
                <hr>
            <h3><i class="material-icons">book</i>Enter your phenotype term query here:</h3>
            {{ form.csrf_token }}
            <input name="typeahead" id="typeahead" class="form-control autocomplete" rows="4" placeholder="cleft palate">
            <span class="form-text text-muted">Please enter your phenotype term and submit with "Search," or restart text entry with "Reset."</span>
		</div> 

		<!-- text box to enter patient description -->
		<div class="form-group" id="doc2hpo" style="display:none;">
                <hr>
                <div class="container" style="text-align:center">
                <code style="font-weight: 300; background-color: #ffffff; color: #555555;">Here, you can submit patient notes through HTTPS to Doc2HPO for parsing out HPO terms.<br>By submitting here, you admit these are deidentified notes and take responsibility for the security of PHI.</code>
                </div>
                <hr>
			<h3><i class="material-icons">assignment</i>Patient Description</h3>
			<textarea class="form-control" name="doc2hpo_notes" id="doc2hpo_notes" rows="10" placeholder="Individual II-2 is a 9 years old girl. She does not have microcephaly. She was born at term, also with normal birth parameters. She began to stand at 11 months, walk with aid at 13 months, and speak at 17 months. At age 5, she was just like other children of similar age, with the ability to dress and sing, and count by herself. Starting at 6 years of age, she began to show regression of developmental patterns: she could not dress by herself anymore, and could not express even a single sentence or count numbers. Clinical examination revealed a coarse face with low anterior and posterior hairlines, prominent frontal bossing, thick eyebrows, synophrys (unibrow), hypertelorism, and thick lips. Growth parameters were normal. Her clinical course was also severe, with progressive neurodegeneration, behavioral problems (including hyperactivity, impulsivity, obstinacy, anxious behaviors and autistic-like behaviors), and hearing loss. The diagnosis of severe intellectual disability was made, based on Wechsler Intelligence Scale examination. Measuring activities of daily living showed extreme disability. Brain MRI demonstrated cortical atrophy with enlargement of the subarachnoid spaces and ventricular dilatation (Figure 2). Brainstem evoked potentials showed moderate abnormalities. EEG recording showed abnormal sleep EEG, just like her brotherâ€™s manifestation."></textarea>
                        <p> Sample deidentified clinical notes slightly modified to demonstrate features, but courtesy of <a target="_blank" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4267425/">Shi and Li et al. 2014</a>.
			<span class="form-text text-muted">Submit clinical notes with "Search", or restart text entry with "Reset."</span>
		</div> 

		<!-- submit and reset buttons -->
		<div class="form-group">
			{{ form.csrf_token }}
            <button type="reset" class="btn btn-success" style="margin-right: 16px"><i class="material-icons" style="font-size: 16px">redo</i>Reset</button>
            <button type="submit" class="btn btn-info"><i class="material-icons" style="font-size: 16px">send</i>Search</button>
        </div>
	</form> 
</div>
{% endblock %}

{% block scripts %}
<!-- toggle between manual HPO ids and using doc2hpo -->
<script type="text/javascript">

    // clicked on manual tab
    $('#manual-tab').on('click', function (e) {
        e.preventDefault();
        $("#auto").hide();
        $("#doc2hpo").hide();
        $("#manual").show();
        $("#doc2hpo-tab").removeClass("active");
        $("#auto-tab").removeClass("active");
        $("#manual-tab").addClass("active");

        // uncheck doc2hpo checkbox
        $( "#doc2hpo_check" ).prop("checked", false);
    });

    // clicked on autocompletion tab
    $('#auto-tab').on('click', function (e) {
        e.preventDefault();
        $("#manual").hide();
        $("#doc2hpo").hide();
        $("#auto").show();
        $("#doc2hpo-tab").removeClass("active");
        $("#manual-tab").removeClass("active");
        $("#auto-tab").addClass("active");
        // uncheck doc2hpo checkbox
        $( "#doc2hpo_check" ).prop("checked", false);
    });

    // clicked on doc2hpo tab
    $('#doc2hpo-tab').on('click', function (e) {
        e.preventDefault();
        $("#manual").hide();
        $("#auto").hide();
        $("#doc2hpo").show();
        $("#manual-tab").removeClass("active");
        $("#auto-tab").removeClass("active");
        $("#doc2hpo-tab").addClass("active");

        // check doc2hpo checkbox
        $( "#doc2hpo_check" ).prop("checked", true);
    });


</script>
{% endblock %}
